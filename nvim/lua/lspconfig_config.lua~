local lspconfig = require("lspconfig")
local util = require("lspconfig/util")
local capabilities = vim.lsp.protocol.make_client_capabilities()

capabilities.textDocument.completion.completionItem.snippetSupport = true

lspconfig.gopls.setup({
	on_attach = on_attach,
	capabilities = capabilities,
	cmd = { "gopls" },
	filetypes = { "go", "gomod", "gowork", "gotmpl" },
})
vim.lsp.enable("phpactor")

local tsserver_filetypes = { 'typescript', 'javascript', 'javascriptreact', 'typescriptreact', 'vue', 'ts' }

local vue_plugin = {
  name = '@vue/typescript-plugin',
  location = '/home/fiwer/.config/nvm/versions/node/v24.1.0/lib/node_modules/@vue/language-server',
  languages = { 'vue' },
  configNamespace = 'typescript',
}
local vtsls_config = {
  settings = {
    vtsls = {
      tsserver = {
        globalPlugins = {
          vue_plugin,
        },
      },
    },
  },
  filetypes = tsserver_filetypes,
}
local ts_ls_config = {
  init_options = {
    plugins = {
      vue_plugin,
    },
  },
  filetypes = tsserver_filetypes,
}

local vue_ls_config = {}
--
vim.lsp.config('vtsls', vtsls_config)
vim.lsp.config('vue_ls', vue_ls_config)
vim.lsp.config('ts_ls', ts_ls_config)
vim.lsp.enable({'vtsls', 'vue_ls'})
-- require("lspconfig").volar.setup({
-- 	filetypes = { "typescript", "javascript", "javascriptreact", "typescriptreact", "vue", "ts" },
-- 	-- /home/fiwer/.config/nvm/versions/node/v24.1.0/lib/node_modules/typescript-language-server
-- 	-- location = "/home/fiwer/.config/nvm/versions/node/v24.1.0/lib/node_modules/@vue/language-server",
-- 	init_options = {
-- 		vue = {
-- 			hybridMode = false,
-- 		},
-- 	},
-- })
-- require("lspconfig").ts_ls.setup({
-- 	init_options = {
-- 		plugins = {
-- 			{
-- 				name = "@vue/typescript-plugin",
-- 				--location = "/usr/local/lib/node_modules/@vue/typescript-plugin",
-- 				location = "/home/fiwer/.config/nvm/versions/node/v24.1.0/lib/node_modules/typescript-language-server",
-- 				languages = { "javascript", "typescript", "vue", "ts" },
-- 			},
-- 		},
-- 	},
-- 	filetypes = {
-- 		"javascript",
-- 		"ts",
-- 		"typescript",
-- 		"vue",
-- 	},
-- })
require("lspconfig").tailwindcss.setup({})
vim.keymap.set("n", "<leader>sr", vim.lsp.buf.rename)
vim.keymap.set("n", "<Leader>ih", function()
	vim.lsp.inlay_hint.enable(not vim.lsp.inlay_hint.is_enabled())
end, { desc = "Toggle Inlay Hints" })
--require'lspconfig'.phpactor.setup{
--    on_attach = on_attach,
--    init_options = {
--        ["language_server_phpstan.enabled"] = false,
--        ["language_server_psalm.enabled"] = false,
--    }
--}
